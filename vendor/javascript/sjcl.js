import e from"crypto";var i={};var n={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(e){this.toString=function(){return"CORRUPT: "+this.message};this.message=e},invalid:function(e){this.toString=function(){return"INVALID: "+this.message};this.message=e},bug:function(e){this.toString=function(){return"BUG: "+this.message};this.message=e},notReady:function(e){this.toString=function(){return"NOT READY: "+this.message};this.message=e}}};n.cipher.aes=function(e){this.s[0][0][0]||this.O();var i,r,o,c,s=this.s[0][4],h=this.s[1];i=e.length;var l=1;if(4!==i&&6!==i&&8!==i)throw new n.exception.invalid("invalid aes key size");this.b=[o=e.slice(0),c=[]];for(e=i;e<4*i+28;e++){r=o[e-1];(0===e%i||8===i&&4===e%i)&&(r=s[r>>>24]<<24^s[r>>16&255]<<16^s[r>>8&255]<<8^s[255&r],0===e%i&&(r=r<<8^r>>>24^l<<24,l=l<<1^283*(l>>7)));o[e]=o[e-i]^r}for(i=0;e;i++,e--)r=o[3&i?e:e-4],c[i]=4>=e||4>i?r:h[0][s[r>>>24]]^h[1][s[r>>16&255]]^h[2][s[r>>8&255]]^h[3][s[255&r]]};n.cipher.aes.prototype={encrypt:function(e){return t(this,e,0)},decrypt:function(e){return t(this,e,1)},s:[[[],[],[],[],[]],[[],[],[],[],[]]],O:function(){var e=this.s[0],i=this.s[1],n=e[4],r=i[4],o,c,s,h=[],l=[],d,f,p,m;for(o=0;256>o;o++)l[(h[o]=o<<1^283*(o>>7))^o]=o;for(c=s=0;!n[c];c^=d||1,s=l[s]||1)for(p=s^s<<1^s<<2^s<<3^s<<4,p=p>>8^255&p^99,n[c]=p,r[p]=c,f=h[o=h[d=h[c]]],m=16843009*f^65537*o^257*d^16843008*c,f=257*h[p]^16843008*p,o=0;4>o;o++)e[o][c]=f=f<<24^f>>>8,i[o][p]=m=m<<24^m>>>8;for(o=0;5>o;o++)e[o]=e[o].slice(0),i[o]=i[o].slice(0)}};function t(e,i,r){if(4!==i.length)throw new n.exception.invalid("invalid aes block size");var o=e.b[r],c=i[0]^o[0],s=i[r?3:1]^o[1],h=i[2]^o[2];i=i[r?1:3]^o[3];var l,d,f,p=o.length/4-2,m,g=4,b=[0,0,0,0];l=e.s[r];e=l[0];var v=l[1],w=l[2],k=l[3],L=l[4];for(m=0;m<p;m++)l=e[c>>>24]^v[s>>16&255]^w[h>>8&255]^k[255&i]^o[g],d=e[s>>>24]^v[h>>16&255]^w[i>>8&255]^k[255&c]^o[g+1],f=e[h>>>24]^v[i>>16&255]^w[c>>8&255]^k[255&s]^o[g+2],i=e[i>>>24]^v[c>>16&255]^w[s>>8&255]^k[255&h]^o[g+3],g+=4,c=l,s=d,h=f;for(m=0;4>m;m++)b[r?3&-m:m]=L[c>>>24]<<24^L[s>>16&255]<<16^L[h>>8&255]<<8^L[255&i]^o[g++],l=c,c=s,s=h,h=i,i=l;return b}n.bitArray={bitSlice:function(e,i,r){e=n.bitArray.$(e.slice(i/32),32-(31&i)).slice(1);return void 0===r?e:n.bitArray.clamp(e,r-i)},extract:function(e,i,n){var r=Math.floor(-i-n&31);return(-32&(i+n-1^i)?e[i/32|0]<<32-r^e[i/32+1|0]>>>r:e[i/32|0]>>>r)&(1<<n)-1},concat:function(e,i){if(0===e.length||0===i.length)return e.concat(i);var r=e[e.length-1],o=n.bitArray.getPartial(r);return 32===o?e.concat(i):n.bitArray.$(i,o,0|r,e.slice(0,e.length-1))},bitLength:function(e){var i=e.length;return 0===i?0:32*(i-1)+n.bitArray.getPartial(e[i-1])},clamp:function(e,i){if(32*e.length<i)return e;e=e.slice(0,Math.ceil(i/32));var r=e.length;i&=31;0<r&&i&&(e[r-1]=n.bitArray.partial(i,e[r-1]&2147483648>>i-1,1));return e},partial:function(e,i,n){return 32===e?i:(n?0|i:i<<32-e)+1099511627776*e},getPartial:function(e){return Math.round(e/1099511627776)||32},equal:function(e,i){if(n.bitArray.bitLength(e)!==n.bitArray.bitLength(i))return!1;var r=0,o;for(o=0;o<e.length;o++)r|=e[o]^i[o];return 0===r},$:function(e,i,r,o){var c;c=0;for(void 0===o&&(o=[]);32<=i;i-=32)o.push(r),r=0;if(0===i)return o.concat(e);for(c=0;c<e.length;c++)o.push(r|e[c]>>>i),r=e[c]<<32-i;c=e.length?e[e.length-1]:0;e=n.bitArray.getPartial(c);o.push(n.bitArray.partial(i+e&31,32<i+e?r:o.pop(),1));return o},i:function(e,i){return[e[0]^i[0],e[1]^i[1],e[2]^i[2],e[3]^i[3]]},byteswapM:function(e){var i,n;for(i=0;i<e.length;++i)n=e[i],e[i]=n>>>24|n>>>8&65280|(65280&n)<<8|n<<24;return e}};n.codec.utf8String={fromBits:function(e){var i="",r=n.bitArray.bitLength(e),o,c;for(o=0;o<r/8;o++)0===(3&o)&&(c=e[o/4]),i+=String.fromCharCode(c>>>8>>>8>>>8),c<<=8;return decodeURIComponent(escape(i))},toBits:function(e){e=unescape(encodeURIComponent(e));var i=[],r,o=0;for(r=0;r<e.length;r++)o=o<<8|e.charCodeAt(r),3===(3&r)&&(i.push(o),o=0);3&r&&i.push(n.bitArray.partial(8*(3&r),o));return i}};n.codec.hex={fromBits:function(e){var i="",r;for(r=0;r<e.length;r++)i+=((0|e[r])+0xf00000000000).toString(16).substr(4);return i.substr(0,n.bitArray.bitLength(e)/4)},toBits:function(e){var i,r=[],o;e=e.replace(/\s|0x/g,"");o=e.length;e+="00000000";for(i=0;i<e.length;i+=8)r.push(0^parseInt(e.substr(i,8),16));return n.bitArray.clamp(r,4*o)}};n.codec.base32={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",X:"0123456789ABCDEFGHIJKLMNOPQRSTUV",BITS:32,BASE:5,REMAINING:27,fromBits:function(e,i,r){var o=n.codec.base32.BASE,c=n.codec.base32.REMAINING,s="",h=0,l=n.codec.base32.B,d=0,f=n.bitArray.bitLength(e);r&&(l=n.codec.base32.X);for(r=0;s.length*o<f;)s+=l.charAt((d^e[r]>>>h)>>>c),h<o?(d=e[r]<<o-h,h+=c,r++):(d<<=o,h-=o);for(;7&s.length&&!i;)s+="=";return s},toBits:function(e,i){e=e.replace(/\s|=/g,"").toUpperCase();var r=n.codec.base32.BITS,o=n.codec.base32.BASE,c=n.codec.base32.REMAINING,s=[],h,l=0,d=n.codec.base32.B,f=0,p,m="base32";i&&(d=n.codec.base32.X,m="base32hex");for(h=0;h<e.length;h++){p=d.indexOf(e.charAt(h));if(0>p){if(!i)try{return n.codec.base32hex.toBits(e)}catch(e){}throw new n.exception.invalid("this isn't "+m+"!")}l>c?(l-=c,s.push(f^p>>>l),f=p<<r-l):(l+=o,f^=p<<r-l)}56&l&&s.push(n.bitArray.partial(56&l,f,1));return s}};n.codec.base32hex={fromBits:function(e,i){return n.codec.base32.fromBits(e,i,1)},toBits:function(e){return n.codec.base32.toBits(e,1)}};n.codec.base64={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(e,i,r){var o="",c=0,s=n.codec.base64.B,h=0,l=n.bitArray.bitLength(e);r&&(s=s.substr(0,62)+"-_");for(r=0;6*o.length<l;)o+=s.charAt((h^e[r]>>>c)>>>26),6>c?(h=e[r]<<6-c,c+=26,r++):(h<<=6,c-=6);for(;3&o.length&&!i;)o+="=";return o},toBits:function(e,i){e=e.replace(/\s|=/g,"");var r=[],o,c=0,s=n.codec.base64.B,h=0,l;i&&(s=s.substr(0,62)+"-_");for(o=0;o<e.length;o++){l=s.indexOf(e.charAt(o));if(0>l)throw new n.exception.invalid("this isn't base64!");26<c?(c-=26,r.push(h^l>>>c),h=l<<32-c):(c+=6,h^=l<<32-c)}56&c&&r.push(n.bitArray.partial(56&c,h,1));return r}};n.codec.base64url={fromBits:function(e){return n.codec.base64.fromBits(e,1,1)},toBits:function(e){return n.codec.base64.toBits(e,1)}};n.hash.sha256=function(e){this.b[0]||this.O();e?(this.F=e.F.slice(0),this.A=e.A.slice(0),this.l=e.l):this.reset()};n.hash.sha256.hash=function(e){return(new n.hash.sha256).update(e).finalize()};n.hash.sha256.prototype={blockSize:512,reset:function(){this.F=this.Y.slice(0);this.A=[];this.l=0;return this},update:function(e){"string"===typeof e&&(e=n.codec.utf8String.toBits(e));var i,r=this.A=n.bitArray.concat(this.A,e);i=this.l;e=this.l=i+n.bitArray.bitLength(e);if(9007199254740991<e)throw new n.exception.invalid("Cannot hash more than 2^53 - 1 bits");if("undefined"!==typeof Uint32Array){var o=new Uint32Array(r),c=0;for(i=512+i-(512+i&511);i<=e;i+=512)u(this,o.subarray(16*c,16*(c+1))),c+=1;r.splice(0,16*c)}else for(i=512+i-(512+i&511);i<=e;i+=512)u(this,r.splice(0,16));return this},finalize:function(){var e,i=this.A,r=this.F,i=n.bitArray.concat(i,[n.bitArray.partial(1,1)]);for(e=i.length+2;15&e;e++)i.push(0);i.push(Math.floor(this.l/4294967296));for(i.push(0|this.l);i.length;)u(this,i.splice(0,16));this.reset();return r},Y:[],b:[],O:function(){function a(e){return 4294967296*(e-Math.floor(e))|0}for(var e=0,i=2,n,r;64>e;i++){r=!0;for(n=2;n*n<=i;n++)if(0===i%n){r=!1;break}r&&(8>e&&(this.Y[e]=a(Math.pow(i,.5))),this.b[e]=a(Math.pow(i,1/3)),e++)}}};function u(e,i){var n,r,o,c=e.F,s=e.b,h=c[0],l=c[1],d=c[2],f=c[3],p=c[4],m=c[5],g=c[6],b=c[7];for(n=0;64>n;n++)16>n?r=i[n]:(r=i[n+1&15],o=i[n+14&15],r=i[15&n]=(r>>>7^r>>>18^r>>>3^r<<25^r<<14)+(o>>>17^o>>>19^o>>>10^o<<15^o<<13)+i[15&n]+i[n+9&15]|0),r=r+b+(p>>>6^p>>>11^p>>>25^p<<26^p<<21^p<<7)+(g^p&(m^g))+s[n],b=g,g=m,m=p,p=f+r|0,f=d,d=l,l=h,h=r+(l&d^f&(l^d))+(l>>>2^l>>>13^l>>>22^l<<30^l<<19^l<<10)|0;c[0]=c[0]+h|0;c[1]=c[1]+l|0;c[2]=c[2]+d|0;c[3]=c[3]+f|0;c[4]=c[4]+p|0;c[5]=c[5]+m|0;c[6]=c[6]+g|0;c[7]=c[7]+b|0}n.mode.ccm={name:"ccm",G:[],listenProgress:function(e){n.mode.ccm.G.push(e)},unListenProgress:function(e){e=n.mode.ccm.G.indexOf(e);-1<e&&n.mode.ccm.G.splice(e,1)},fa:function(e){var i=n.mode.ccm.G.slice(),r;for(r=0;r<i.length;r+=1)i[r](e)},encrypt:function(e,i,r,o,c){var s,h=i.slice(0),l=n.bitArray,d=l.bitLength(r)/8,f=l.bitLength(h)/8;c=c||64;o=o||[];if(7>d)throw new n.exception.invalid("ccm: iv must be at least 7 bytes");for(s=2;4>s&&f>>>8*s;s++);s<15-d&&(s=15-d);r=l.clamp(r,8*(15-s));i=n.mode.ccm.V(e,i,r,o,c,s);h=n.mode.ccm.C(e,h,r,i,c,s);return l.concat(h.data,h.tag)},decrypt:function(e,i,r,o,c){c=c||64;o=o||[];var s=n.bitArray,h=s.bitLength(r)/8,l=s.bitLength(i),d=s.clamp(i,l-c),f=s.bitSlice(i,l-c),l=(l-c)/8;if(7>h)throw new n.exception.invalid("ccm: iv must be at least 7 bytes");for(i=2;4>i&&l>>>8*i;i++);i<15-h&&(i=15-h);r=s.clamp(r,8*(15-i));d=n.mode.ccm.C(e,d,r,f,c,i);e=n.mode.ccm.V(e,d.data,r,o,c,i);if(!s.equal(d.tag,e))throw new n.exception.corrupt("ccm: tag doesn't match");return d.data},na:function(e,i,r,o,c,s){var h=[],l=n.bitArray,d=l.i;o=[l.partial(8,(i.length?64:0)|o-2<<2|s-1)];o=l.concat(o,r);o[3]|=c;o=e.encrypt(o);if(i.length)for(r=l.bitLength(i)/8,65279>=r?h=[l.partial(16,r)]:4294967295>=r&&(h=l.concat([l.partial(16,65534)],[r])),h=l.concat(h,i),i=0;i<h.length;i+=4)o=e.encrypt(d(o,h.slice(i,i+4).concat([0,0,0])));return o},V:function(e,i,r,o,c,s){var h=n.bitArray,l=h.i;c/=8;if(c%2||4>c||16<c)throw new n.exception.invalid("ccm: invalid tag length");if(4294967295<o.length||4294967295<i.length)throw new n.exception.bug("ccm: can't deal with 4GiB or more data");r=n.mode.ccm.na(e,o,r,c,h.bitLength(i)/8,s);for(o=0;o<i.length;o+=4)r=e.encrypt(l(r,i.slice(o,o+4).concat([0,0,0])));return h.clamp(r,8*c)},C:function(e,i,r,o,c,s){var h,l=n.bitArray;h=l.i;var d=i.length,f=l.bitLength(i),p=d/50,m=p;r=l.concat([l.partial(8,s-1)],r).concat([0,0,0]).slice(0,4);o=l.bitSlice(h(o,e.encrypt(r)),0,c);if(!d)return{tag:o,data:[]};for(h=0;h<d;h+=4)h>p&&(n.mode.ccm.fa(h/d),p+=m),r[3]++,c=e.encrypt(r),i[h]^=c[0],i[h+1]^=c[1],i[h+2]^=c[2],i[h+3]^=c[3];return{tag:o,data:l.clamp(i,f)}}};n.mode.ocb2={name:"ocb2",encrypt:function(e,i,r,o,c,s){if(128!==n.bitArray.bitLength(r))throw new n.exception.invalid("ocb iv must be 128 bits");var h,l=n.mode.ocb2.S,d=n.bitArray,f=d.i,p=[0,0,0,0];r=l(e.encrypt(r));var m,g=[];o=o||[];c=c||64;for(h=0;h+4<i.length;h+=4)m=i.slice(h,h+4),p=f(p,m),g=g.concat(f(r,e.encrypt(f(r,m)))),r=l(r);m=i.slice(h);i=d.bitLength(m);h=e.encrypt(f(r,[0,0,0,i]));m=d.clamp(f(m.concat([0,0,0]),h),i);p=f(p,f(m.concat([0,0,0]),h));p=e.encrypt(f(p,f(r,l(r))));o.length&&(p=f(p,s?o:n.mode.ocb2.pmac(e,o)));return g.concat(d.concat(m,d.clamp(p,c)))},decrypt:function(e,i,r,o,c,s){if(128!==n.bitArray.bitLength(r))throw new n.exception.invalid("ocb iv must be 128 bits");c=c||64;var h=n.mode.ocb2.S,l=n.bitArray,d=l.i,f=[0,0,0,0],p=h(e.encrypt(r)),m,g,b=n.bitArray.bitLength(i)-c,v=[];o=o||[];for(r=0;r+4<b/32;r+=4)m=d(p,e.decrypt(d(p,i.slice(r,r+4)))),f=d(f,m),v=v.concat(m),p=h(p);g=b-32*r;m=e.encrypt(d(p,[0,0,0,g]));m=d(m,l.clamp(i.slice(r),g).concat([0,0,0]));f=d(f,m);f=e.encrypt(d(f,d(p,h(p))));o.length&&(f=d(f,s?o:n.mode.ocb2.pmac(e,o)));if(!l.equal(l.clamp(f,c),l.bitSlice(i,b)))throw new n.exception.corrupt("ocb: tag doesn't match");return v.concat(l.clamp(m,g))},pmac:function(e,i){var r,o=n.mode.ocb2.S,c=n.bitArray,s=c.i,h=[0,0,0,0],l=e.encrypt([0,0,0,0]),l=s(l,o(o(l)));for(r=0;r+4<i.length;r+=4)l=o(l),h=s(h,e.encrypt(s(l,i.slice(r,r+4))));r=i.slice(r);128>c.bitLength(r)&&(l=s(l,o(l)),r=c.concat(r,[-2147483648,0,0,0]));h=s(h,r);return e.encrypt(s(o(s(l,o(l))),h))},S:function(e){return[e[0]<<1^e[1]>>>31,e[1]<<1^e[2]>>>31,e[2]<<1^e[3]>>>31,e[3]<<1^135*(e[0]>>>31)]}};n.mode.gcm={name:"gcm",encrypt:function(e,i,r,o,c){var s=i.slice(0);i=n.bitArray;o=o||[];e=n.mode.gcm.C(!0,e,s,o,r,c||128);return i.concat(e.data,e.tag)},decrypt:function(e,i,r,o,c){var s=i.slice(0),h=n.bitArray,l=h.bitLength(s);c=c||128;o=o||[];c<=l?(i=h.bitSlice(s,l-c),s=h.bitSlice(s,0,l-c)):(i=s,s=[]);e=n.mode.gcm.C(!1,e,s,o,r,c);if(!h.equal(e.tag,i))throw new n.exception.corrupt("gcm: tag doesn't match");return e.data},ka:function(e,i){var r,o,c,s,h,l=n.bitArray.i;c=[0,0,0,0];s=i.slice(0);for(r=0;128>r;r++){(o=0!==(e[Math.floor(r/32)]&1<<31-r%32))&&(c=l(c,s));h=0!==(1&s[3]);for(o=3;0<o;o--)s[o]=s[o]>>>1|(1&s[o-1])<<31;s[0]>>>=1;h&&(s[0]^=-520093696)}return c},j:function(e,i,r){var o,c=r.length;i=i.slice(0);for(o=0;o<c;o+=4)i[0]^=4294967295&r[o],i[1]^=4294967295&r[o+1],i[2]^=4294967295&r[o+2],i[3]^=4294967295&r[o+3],i=n.mode.gcm.ka(i,e);return i},C:function(e,i,r,o,c,s){var h,l,d,f,p,m,g,b,v=n.bitArray;m=r.length;g=v.bitLength(r);b=v.bitLength(o);l=v.bitLength(c);h=i.encrypt([0,0,0,0]);96===l?(c=c.slice(0),c=v.concat(c,[1])):(c=n.mode.gcm.j(h,[0,0,0,0],c),c=n.mode.gcm.j(h,c,[0,0,Math.floor(l/4294967296),4294967295&l]));l=n.mode.gcm.j(h,[0,0,0,0],o);p=c.slice(0);o=l.slice(0);e||(o=n.mode.gcm.j(h,l,r));for(f=0;f<m;f+=4)p[3]++,d=i.encrypt(p),r[f]^=d[0],r[f+1]^=d[1],r[f+2]^=d[2],r[f+3]^=d[3];r=v.clamp(r,g);e&&(o=n.mode.gcm.j(h,l,r));e=[Math.floor(b/4294967296),4294967295&b,Math.floor(g/4294967296),4294967295&g];o=n.mode.gcm.j(h,o,e);d=i.encrypt(c);o[0]^=d[0];o[1]^=d[1];o[2]^=d[2];o[3]^=d[3];return{tag:v.bitSlice(o,0,s),data:r}}};n.misc.hmac=function(e,i){this.W=i=i||n.hash.sha256;var r=[[],[]],o,c=i.prototype.blockSize/32;this.w=[new i,new i];e.length>c&&(e=i.hash(e));for(o=0;o<c;o++)r[0][o]=909522486^e[o],r[1][o]=1549556828^e[o];this.w[0].update(r[0]);this.w[1].update(r[1]);this.R=new i(this.w[0])};n.misc.hmac.prototype.encrypt=n.misc.hmac.prototype.mac=function(e){if(this.aa)throw new n.exception.invalid("encrypt on already updated hmac called!");this.update(e);return this.digest(e)};n.misc.hmac.prototype.reset=function(){this.R=new this.W(this.w[0]);this.aa=!1};n.misc.hmac.prototype.update=function(e){this.aa=!0;this.R.update(e)};n.misc.hmac.prototype.digest=function(){var e=this.R.finalize(),e=new this.W(this.w[1]).update(e).finalize();this.reset();return e};n.misc.pbkdf2=function(e,i,r,o,c){r=r||1e4;if(0>o||0>r)throw new n.exception.invalid("invalid params to pbkdf2");"string"===typeof e&&(e=n.codec.utf8String.toBits(e));"string"===typeof i&&(i=n.codec.utf8String.toBits(i));c=c||n.misc.hmac;e=new c(e);var s,h,l,d,f=[],p=n.bitArray;for(d=1;32*f.length<(o||1);d++){c=s=e.encrypt(p.concat(i,[d]));for(h=1;h<r;h++)for(s=e.encrypt(s),l=0;l<s.length;l++)c[l]^=s[l];f=f.concat(c)}o&&(f=p.clamp(f,o));return f};n.prng=function(e){this.c=[new n.hash.sha256];this.m=[0];this.P=0;this.H={};this.N=0;this.U={};this.Z=this.f=this.o=this.ha=0;this.b=[0,0,0,0,0,0,0,0];this.h=[0,0,0,0];this.L=void 0;this.M=e;this.D=!1;this.K={progress:{},seeded:{}};this.u=this.ga=0;this.I=1;this.J=2;this.ca=65536;this.T=[0,48,64,96,128,192,256,384,512,768,1024];this.da=3e4;this.ba=80};n.prng.prototype={randomWords:function(e,i){var r=[],o;o=this.isReady(i);var c;if(o===this.u)throw new n.exception.notReady("generator isn't seeded");if(o&this.J){o=!(o&this.I);c=[];var s=0,h;this.Z=c[0]=(new Date).valueOf()+this.da;for(h=0;16>h;h++)c.push(4294967296*Math.random()|0);for(h=0;h<this.c.length&&(c=c.concat(this.c[h].finalize()),s+=this.m[h],this.m[h]=0,o||!(this.P&1<<h));h++);this.P>=1<<this.c.length&&(this.c.push(new n.hash.sha256),this.m.push(0));this.f-=s;s>this.o&&(this.o=s);this.P++;this.b=n.hash.sha256.hash(this.b.concat(c));this.L=new n.cipher.aes(this.b);for(o=0;4>o&&(this.h[o]=this.h[o]+1|0,!this.h[o]);o++);}for(o=0;o<e;o+=4)0===(o+1)%this.ca&&y(this),c=z(this),r.push(c[0],c[1],c[2],c[3]);y(this);return r.slice(0,e)},setDefaultParanoia:function(e,i){if(0===e&&"Setting paranoia=0 will ruin your security; use it only for testing"!==i)throw new n.exception.invalid("Setting paranoia=0 will ruin your security; use it only for testing");this.M=e},addEntropy:function(e,i,r){r=r||"user";var o,c,s=(new Date).valueOf(),h=this.H[r],l=this.isReady(),d=0;o=this.U[r];void 0===o&&(o=this.U[r]=this.ha++);void 0===h&&(h=this.H[r]=0);this.H[r]=(this.H[r]+1)%this.c.length;switch(typeof e){case"number":void 0===i&&(i=1);this.c[h].update([o,this.N++,1,i,s,1,0|e]);break;case"object":r=Object.prototype.toString.call(e);if("[object Uint32Array]"===r){c=[];for(r=0;r<e.length;r++)c.push(e[r]);e=c}else for("[object Array]"!==r&&(d=1),r=0;r<e.length&&!d;r++)"number"!==typeof e[r]&&(d=1);if(!d){if(void 0===i)for(r=i=0;r<e.length;r++)for(c=e[r];0<c;)i++,c>>>=1;this.c[h].update([o,this.N++,2,i,s,e.length].concat(e))}break;case"string":void 0===i&&(i=e.length);this.c[h].update([o,this.N++,3,i,s,e.length]);this.c[h].update(e);break;default:d=1}if(d)throw new n.exception.bug("random: addEntropy only supports number, array of numbers or string");this.m[h]+=i;this.f+=i;l===this.u&&(this.isReady()!==this.u&&A("seeded",Math.max(this.o,this.f)),A("progress",this.getProgress()))},isReady:function(e){e=this.T[void 0!==e?e:this.M];return this.o&&this.o>=e?this.m[0]>this.ba&&(new Date).valueOf()>this.Z?this.J|this.I:this.I:this.f>=e?this.J|this.u:this.u},getProgress:function(e){e=this.T[e||this.M];return this.o>=e||this.f>e?1:this.f/e},startCollectors:function(){if(!this.D){this.a={loadTimeCollector:B(this,this.ma),mouseCollector:B(this,this.oa),keyboardCollector:B(this,this.la),accelerometerCollector:B(this,this.ea),touchCollector:B(this,this.qa)};if(window.addEventListener)window.addEventListener("load",this.a.loadTimeCollector,!1),window.addEventListener("mousemove",this.a.mouseCollector,!1),window.addEventListener("keypress",this.a.keyboardCollector,!1),window.addEventListener("devicemotion",this.a.accelerometerCollector,!1),window.addEventListener("touchmove",this.a.touchCollector,!1);else{if(!document.attachEvent)throw new n.exception.bug("can't attach event");document.attachEvent("onload",this.a.loadTimeCollector),document.attachEvent("onmousemove",this.a.mouseCollector),document.attachEvent("keypress",this.a.keyboardCollector)}this.D=!0}},stopCollectors:function(){this.D&&(window.removeEventListener?(window.removeEventListener("load",this.a.loadTimeCollector,!1),window.removeEventListener("mousemove",this.a.mouseCollector,!1),window.removeEventListener("keypress",this.a.keyboardCollector,!1),window.removeEventListener("devicemotion",this.a.accelerometerCollector,!1),window.removeEventListener("touchmove",this.a.touchCollector,!1)):document.detachEvent&&(document.detachEvent("onload",this.a.loadTimeCollector),document.detachEvent("onmousemove",this.a.mouseCollector),document.detachEvent("keypress",this.a.keyboardCollector)),this.D=!1)},addEventListener:function(e,i){this.K[e][this.ga++]=i},removeEventListener:function(e,i){var n,r,o=this.K[e],c=[];for(r in o)o.hasOwnProperty(r)&&o[r]===i&&c.push(r);for(n=0;n<c.length;n++)r=c[n],delete o[r]},la:function(){C(this,1)},oa:function(e){var i,n;try{i=e.x||e.clientX||e.offsetX||0,n=e.y||e.clientY||e.offsetY||0}catch(e){n=i=0}0!=i&&0!=n&&this.addEntropy([i,n],2,"mouse");C(this,0)},qa:function(e){e=e.touches[0]||e.changedTouches[0];this.addEntropy([e.pageX||e.clientX,e.pageY||e.clientY],1,"touch");C(this,0)},ma:function(){C(this,2)},ea:function(e){e=e.accelerationIncludingGravity.x||e.accelerationIncludingGravity.y||e.accelerationIncludingGravity.z;if(window.orientation){var i=window.orientation;"number"===typeof i&&this.addEntropy(i,1,"accelerometer")}e&&this.addEntropy(e,2,"accelerometer");C(this,0)}};function A(e,i){var r,o=n.random.K[e],c=[];for(r in o)o.hasOwnProperty(r)&&c.push(o[r]);for(r=0;r<c.length;r++)c[r](i)}function C(e,i){"undefined"!==typeof window&&window.performance&&"function"===typeof window.performance.now?e.addEntropy(window.performance.now(),i,"loadtime"):e.addEntropy((new Date).valueOf(),i,"loadtime")}function y(e){e.b=z(e).concat(z(e));e.L=new n.cipher.aes(e.b)}function z(e){for(var i=0;4>i&&(e.h[i]=e.h[i]+1|0,!e.h[i]);i++);return e.L.encrypt(e.h)}function B(e,i){return function(){i.apply(e,arguments)}}n.random=new n.prng(6);t:try{var r,o,c,s;if(s=i){var h;try{h=e}catch(e){h=null}s=o=h}if(s&&o.randomBytes)r=o.randomBytes(128),r=new Uint32Array(new Uint8Array(r).buffer),n.random.addEntropy(r,1024,"crypto['randomBytes']");else if("undefined"!==typeof window&&"undefined"!==typeof Uint32Array){c=new Uint32Array(32);if(window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(c);else{if(!window.msCrypto||!window.msCrypto.getRandomValues)break t;window.msCrypto.getRandomValues(c)}n.random.addEntropy(c,1024,"crypto['getRandomValues']")}}catch(e){"undefined"!==typeof window&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(e))}n.json={defaults:{v:1,iter:1e4,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},ja:function(e,i,r,o){r=r||{};o=o||{};var c=n.json,s=c.g({iv:n.random.randomWords(4,0)},c.defaults),h;c.g(s,r);r=s.adata;"string"===typeof s.salt&&(s.salt=n.codec.base64.toBits(s.salt));"string"===typeof s.iv&&(s.iv=n.codec.base64.toBits(s.iv));if(!n.mode[s.mode]||!n.cipher[s.cipher]||"string"===typeof e&&100>=s.iter||64!==s.ts&&96!==s.ts&&128!==s.ts||128!==s.ks&&192!==s.ks&&256!==s.ks||2>s.iv.length||4<s.iv.length)throw new n.exception.invalid("json encrypt: invalid parameters");"string"===typeof e?(h=n.misc.cachedPbkdf2(e,s),e=h.key.slice(0,s.ks/32),s.salt=h.salt):n.ecc&&e instanceof n.ecc.elGamal.publicKey&&(h=e.kem(),s.kemtag=h.tag,e=h.key.slice(0,s.ks/32));"string"===typeof i&&(i=n.codec.utf8String.toBits(i));"string"===typeof r&&(s.adata=r=n.codec.utf8String.toBits(r));h=new n.cipher[s.cipher](e);c.g(o,s);o.key=e;s.ct="ccm"===s.mode&&n.arrayBuffer&&n.arrayBuffer.ccm&&i instanceof ArrayBuffer?n.arrayBuffer.ccm.encrypt(h,i,s.iv,r,s.ts):n.mode[s.mode].encrypt(h,i,s.iv,r,s.ts);return s},encrypt:function(e,i,r,o){var c=n.json,s=c.ja.apply(c,arguments);return c.encode(s)},ia:function(e,i,r,o){r=r||{};o=o||{};var c=n.json;i=c.g(c.g(c.g({},c.defaults),i),r,!0);var s,h;s=i.adata;"string"===typeof i.salt&&(i.salt=n.codec.base64.toBits(i.salt));"string"===typeof i.iv&&(i.iv=n.codec.base64.toBits(i.iv));if(!n.mode[i.mode]||!n.cipher[i.cipher]||"string"===typeof e&&100>=i.iter||64!==i.ts&&96!==i.ts&&128!==i.ts||128!==i.ks&&192!==i.ks&&256!==i.ks||!i.iv||2>i.iv.length||4<i.iv.length)throw new n.exception.invalid("json decrypt: invalid parameters");"string"===typeof e?(h=n.misc.cachedPbkdf2(e,i),e=h.key.slice(0,i.ks/32),i.salt=h.salt):n.ecc&&e instanceof n.ecc.elGamal.secretKey&&(e=e.unkem(n.codec.base64.toBits(i.kemtag)).slice(0,i.ks/32));"string"===typeof s&&(s=n.codec.utf8String.toBits(s));h=new n.cipher[i.cipher](e);s="ccm"===i.mode&&n.arrayBuffer&&n.arrayBuffer.ccm&&i.ct instanceof ArrayBuffer?n.arrayBuffer.ccm.decrypt(h,i.ct,i.iv,i.tag,s,i.ts):n.mode[i.mode].decrypt(h,i.ct,i.iv,s,i.ts);c.g(o,i);o.key=e;return 1===r.raw?s:n.codec.utf8String.fromBits(s)},decrypt:function(e,i,r,o){var c=n.json;return c.ia(e,c.decode(i),r,o)},encode:function(e){var i,r="{",o="";for(i in e)if(e.hasOwnProperty(i)){if(!i.match(/^[a-z0-9]+$/i))throw new n.exception.invalid("json encode: invalid property name");r+=o+'"'+i+'":';o=",";switch(typeof e[i]){case"number":case"boolean":r+=e[i];break;case"string":r+='"'+escape(e[i])+'"';break;case"object":r+='"'+n.codec.base64.fromBits(e[i],0)+'"';break;default:throw new n.exception.bug("json encode: unsupported type")}}return r+"}"},decode:function(e){e=e.replace(/\s/g,"");if(!e.match(/^\{.*\}$/))throw new n.exception.invalid("json decode: this isn't json!");e=e.replace(/^\{|\}$/g,"").split(/,/);var i={},r,o;for(r=0;r<e.length;r++){if(!(o=e[r].match(/^\s*(?:(["']?)([a-z][a-z0-9]*)\1)\s*:\s*(?:(-?\d+)|"([a-z0-9+\/%*_.@=\-]*)"|(true|false))$/i)))throw new n.exception.invalid("json decode: this isn't json!");null!=o[3]?i[o[2]]=parseInt(o[3],10):null!=o[4]?i[o[2]]=o[2].match(/^(ct|adata|salt|iv)$/)?n.codec.base64.toBits(o[4]):unescape(o[4]):null!=o[5]&&(i[o[2]]="true"===o[5])}return i},g:function(e,i,r){void 0===e&&(e={});if(void 0===i)return e;for(var o in i)if(i.hasOwnProperty(o)){if(r&&void 0!==e[o]&&e[o]!==i[o])throw new n.exception.invalid("required parameter overridden");e[o]=i[o]}return e},sa:function(e,i){var n={},r;for(r in e)e.hasOwnProperty(r)&&e[r]!==i[r]&&(n[r]=e[r]);return n},ra:function(e,i){var n={},r;for(r=0;r<i.length;r++)void 0!==e[i[r]]&&(n[i[r]]=e[i[r]]);return n}};n.encrypt=n.json.encrypt;n.decrypt=n.json.decrypt;n.misc.pa={};n.misc.cachedPbkdf2=function(e,i){var r=n.misc.pa,o;i=i||{};o=i.iter||1e3;r=r[e]=r[e]||{};o=r[o]=r[o]||{firstSalt:i.salt&&i.salt.length?i.salt.slice(0):n.random.randomWords(2,0)};r=void 0===i.salt?o.firstSalt:i.salt;o[r]=o[r]||n.misc.pbkdf2(e,r,i.iter);return{key:o[r].slice(0),salt:r.slice(0)}};i&&(i=n);false;var l=i;export default l;

